import React, { useState } from 'react';\nimport { Trophy, TrendingUp, Info, Search } from 'lucide-react';\nimport { getReputation } from '../services/api';\nimport './ReputationViewer.css';\n\nconst ReputationViewer = () => {\n    const [publicKey, setPublicKey] = useState('');\n    const [reputation, setReputation] = useState(null);\n    const [loading, setLoading] = useState(false);\n    const [error, setError] = useState('');\n\n    const checkReputation = async () => {\n        if (!publicKey.trim()) {\n            setError('Please enter a public key');\n            return;\n        }\n\n        setLoading(true);\n        setError('');\n        setReputation(null);\n\n        try {\n            const data = await getReputation(publicKey.trim());\n            setReputation(data);\n        } catch (err) {\n            setError(err.message || 'Failed to fetch reputation');\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    const getReputationLevel = (rep) => {\n        if (rep >= 80) return { level: 'Expert', icon: 'üèÜ', color: '#FFD700' };\n        if (rep >= 60) return { level: 'Trusted', icon: '‚≠ê', color: '#4CAF50' };\n        if (rep >= 40) return { level: 'Reliable', icon: '‚úÖ', color: '#2196F3' };\n        if (rep >= 20) return { level: 'Developing', icon: 'üìà', color: '#FF9800' };\n        return { level: 'Newcomer', icon: 'üë∂', color: '#9E9E9E' };\n    };\n\n    const handleSubmit = (e) => {\n        e.preventDefault();\n        checkReputation();\n    };\n\n    return (\n        <div className=\"reputation-viewer\">\n            <div className=\"reputation-header\">\n                <h2 className=\"reputation-title\">\n                    <Trophy size={24} style={{ marginRight: '10px' }} />\n                    Reputation Checker\n                </h2>\n                <p className=\"reputation-subtitle\">\n                    üîç Look up any user's reputation score based on their voting accuracy\n                </p>\n            </div>\n\n            <form onSubmit={handleSubmit} className=\"reputation-form\">\n                <div className=\"search-container\">\n                    <input\n                        type=\"text\"\n                        value={publicKey}\n                        onChange={(e) => setPublicKey(e.target.value)}\n                        placeholder=\"Enter user's public key (e.g., o8mP/adaST1c4aqcqjUypm10PVIx1dAgYFpSc+3+X6U=)\"\n                        className=\"public-key-input\"\n                    />\n                    <button \n                        type=\"submit\" \n                        className=\"search-btn\"\n                        disabled={loading}\n                    >\n                        {loading ? 'üîÑ' : <Search size={16} />}\n                        {loading ? 'Checking...' : 'Check Reputation'}\n                    </button>\n                </div>\n            </form>\n\n            {error && (\n                <div className=\"reputation-error\">\n                    ‚ùå {error}\n                </div>\n            )}\n\n            {reputation && (\n                <div className=\"reputation-result\">\n                    <div className=\"reputation-card\">\n                        <div className=\"reputation-score\">\n                            <div className=\"score-display\">\n                                <span className=\"score-number\">{reputation.reputation}</span>\n                                <span className=\"score-label\">Reputation Score</span>\n                            </div>\n                            \n                            {(() => {\n                                const level = getReputationLevel(reputation.reputation);\n                                return (\n                                    <div className=\"reputation-badge\" style={{ color: level.color }}>\n                                        <span className=\"badge-icon\">{level.icon}</span>\n                                        <span className=\"badge-level\">{level.level}</span>\n                                    </div>\n                                );\n                            })()}\n                        </div>\n\n                        <div className=\"reputation-bar\">\n                            <div \n                                className=\"reputation-fill\"\n                                style={{ \n                                    width: `${Math.min(reputation.reputation, 100)}%`,\n                                    background: getReputationLevel(reputation.reputation).color\n                                }}\n                            >\n                            </div>\n                        </div>\n\n                        <div className=\"reputation-info\">\n                            <div className=\"info-item\">\n                                <TrendingUp size={16} />\n                                <span>Voting Power: <strong>{Math.max(reputation.reputation, 1).toFixed(1)}x</strong></span>\n                            </div>\n                            \n                            <div className=\"info-item\">\n                                <Info size={16} />\n                                <span>Public Key: <code>{publicKey.substring(0, 20)}...</code></span>\n                            </div>\n                        </div>\n                        \n                        <div className=\"reputation-note\">\n                            üí° {reputation.note || 'Reputation is calculated from historical voting accuracy on finalized rumors'}\n                        </div>\n                    </div>\n                </div>\n            )}\n\n            <div className=\"reputation-explanation\">\n                <h3>How Reputation Works</h3>\n                <ul>\n                    <li>üéØ <strong>Accuracy Matters</strong>: Vote correctly on rumors to gain reputation</li>\n                    <li>‚è∞ <strong>Recent Votes Count More</strong>: New votes have higher impact than old ones</li>\n                    <li>üìà <strong>Exponential Growth</strong>: Consistent accuracy builds reputation faster</li>\n                    <li>üó≥Ô∏è <strong>Voting Power</strong>: Higher reputation = your votes carry more weight</li>\n                    <li>‚è≥ <strong>Probation Period</strong>: New users wait 1 minute before voting</li>\n                </ul>\n            </div>\n        </div>\n    );\n};\n\nexport default ReputationViewer;